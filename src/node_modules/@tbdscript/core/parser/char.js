var read = require("./read")
var unexpected = require("./unexpected")

module.exports = function char(predicate, expected) {
  if (typeof predicate === "string") {
    return char(predicate.charCodeAt(0), predicate)
  }
  if (typeof predicate === "number") {
    return char(function(c) {
      return c === predicate
    }, expected != null ? expected : predicate)
  }
  return function(input, pos, cok, cerr, eok, eerr) {
    if (predicate(input.charCodeAt(pos))) {
      return read(input, pos, cok, cerr, eok, eerr)
    } else {
      return eerr(
        unexpected(pos, expected, String.fromCharCode(input.charCodeAt(pos))),
        pos,
        input
      )
    }
  }
}
