class Env {
  constructor(primitiveExpansions) {
    this.primitiveExpansions = primitiveExpansions
    this.macros = {}
  }

  resolve(form) {
    if (form && typeof form.valueOf() === "symbol") {
      return this.macros[form.valueOf()]
    }
    return undefined
  }

  expandPrimitive(form) {
    if (form === null) {
      return this.primitiveExpansions.null(form, env)
    }
    if (form === undefined) {
      return this.primitiveExpansions.undefined(form, env)
    }
    if (Array.isArray(form)) {
      return this.primitiveExpansions.array(form, env)
    }
    return this.primitiveExpansions[typeof form.valueOf()](form, env)
  }
}

module.exports = Env
