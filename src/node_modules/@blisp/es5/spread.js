const { spreadElement } = require("@babel/types")
const expand = require("@blisp/expander/expand")
const syntaxToDatum = require("@blisp/expander/syntaxToDatum")

module.exports = function spread(stx, env) {
  const form = syntaxToDatum(stx)[1]
  return spreadElement(
    form.type === "ArrayExpression"
      ? {
          ...form,
          elements: form.elements.map((element) => expand(element, env)),
        }
      : expand(form, env)
  )
}
