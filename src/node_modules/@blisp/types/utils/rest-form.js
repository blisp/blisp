module.exports = function restForm(type, id, ...args) {
  function macro(form, env) {
    return args.reduce(
      (syntax, arg, index) => {
        syntax[arg] = expand(form.arguments[index], env)
      },
      { type, loc: form.loc }
    )
  }
  macro.type = type
  macro.helpers = {
    nth(form, n) {
      return n === 0 ? { type: "Identifier", name: id } : form[args[n - 1]]
    },
    length(form) {
      return args + 1
    },
  }
  return { [id]: macro }
}
