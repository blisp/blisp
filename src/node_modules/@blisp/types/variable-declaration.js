const compile = require("@blisp/compiler/compile")
const { variableDeclaration, variableDeclarator } = require("@babel/types")

/**
 *  (#%define var (foo "foo") (bar "bar"))
 *
 */
function VariableDeclaration(form) {
  return variableDeclaration(
    Symbol.keyFor(form[1].valueOf()),
    form
      .slice(2)
      .map((decl) =>
        variableDeclarator(
          compile.call(this, decl[0]),
          decl[1] && compile.call(this, decl[1])
        )
      )
  )
}

module.exports = { [Symbol.for("#%define")]: VariableDeclaration }
